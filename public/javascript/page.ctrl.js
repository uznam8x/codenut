!function(t){t(document);var e=function(e){e.on("click",".treemenu__action__button",function(a){e.find(".treemenu--selected").removeClass("treemenu--selected"),t(a.currentTarget).closest(".treemenu__action").addClass("treemenu--selected")})};t(".treemenu").each(function(a,n){new e(t(n))})}(jQuery),function(t){var e=t(document);e.on("click","#navigator .treemenu__action__add",function(a){a.preventDefault();var n=prompt("Page name","");if(n){var r=t(a.currentTarget).parent(),u=r.next();u.prop("nodeName")||(u=t("<ul/>"),r.parent().append(u));var c=r.closest("[data-codenut-path]").attr("data-codenut-path")||"/",o=(c+"/"+n).replace("//","/"),p=Codenut.o2d.property({path:o,uuid:Codenut.uuid()}),i=Codenut.template.tree.item.replace(/{{name}}/g,n).replace(/{{attribute}}/g,"").replace(/{{property}}/g,p).replace(/{{children}}/g,"");u.append(i),e.trigger({type:"page.create",param:c+"/"+n})}}),e.on("click","#navigator .treemenu__action__button",function(a){var n=t(a.currentTarget).parent().attr("data-codenut-path");t("iframe").attr("src","/page"+n),e.trigger({type:"structure.update",param:n})}),e.on("click","#navigator .toolbar__save",function(){e.trigger({type:"nav.update"})}),e.on("click","#structure .treemenu__action__add",function(a){var n=prompt("Structure name","");if(n){var r=t(a.currentTarget).parent(),u=r.next();u.prop("nodeName")||(u=t("<ul />"),r.parent().append(u));var c=r.closest("[data-path]").attr("data-path")||"",o=Codenut.o2d.attribute({"data-path":c+"/"+n}),p=Codenut.template.tree.item.replace(/{{name}}/g,n).replace(/{{attribute}}/g,o).replace(/{{children}}/g,"");u.append(p),e.trigger({type:"page.update"})}}),e.on("click","#structure .treemenu__action__button",function(t){}),e.on("click","#structure .toolbar__save",function(){e.trigger({type:"page.update"})})}(jQuery),function(t){"use strict";var e=t(document),a=t("#navigator .sortable");a.html(Codenut.j2h.html(Codenut.nav)),e.on("nav.update",function(){var e=Codenut.j2h.json(a.children()),n={url:"/api/nav/update",data:{nav:JSON.stringify(e)},type:"post",success:function(t){Codenut.nav=t.data,a.html(Codenut.j2h.html(Codenut.nav))}};console.log(JSON.stringify(e)),t.ajax(n)})}(jQuery),function(t){"use strict";var e=t(document);e.on("page.create",function(a){var n={url:"/api/page/create",data:{path:a.param},type:"post",success:function(t){e.trigger({type:"nav.update"})}};t.ajax(n)})}(jQuery),function(){"use strict";var t=$(document),e=$("#structure .sortable");t.on("structure.update",function(t){Codenut.page.src="/page"+(t.param||"");if(t.param){var a={url:"/api/page/show",data:{src:Codenut.page.src},type:"get",success:function(t){e.html(Codenut.j2h.html(t.data.body))}};$.ajax(a)}else"/page/",e.html("")})}(),function(t){"use strict";var e=t(document),a=t("#structure .sortable");e.on("page.update",function(){var n={url:"/api/page/update",data:{src:Codenut.page.src,structure:JSON.stringify(Codenut.j2h.json(a.children()))},type:"post",success:function(e){setTimeout(function(){t("iframe").attr("src",Codenut.page.src)},1e3)},error:function(t){setTimeout(function(){e.trigger({type:"page.update"})},2e3)}};t.ajax(n)})}(jQuery);